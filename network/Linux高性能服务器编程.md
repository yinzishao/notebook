第一篇前面四章讲的是网络协议，大多都是大学课本计网的内容，但是更偏向实战注重的部分。值得反复阅读和回顾，然后回归计网了解更多的细节。

第二篇开始将网络编程：从socket简单的使用例子开始，然后到高级的I/O函数，主要是创建文件描述符（管道等）、读写数据的函数（零拷贝）、控制I/O行为和属性的函数（fcntl，file control 设为非阻塞）

前六章给我的感受：很详细，每个知识点希望能说的地方，都能指出方向。也有很多具体的例子。

很实用，之前很多看网络编程的各个知识点都有提到，并且帮忙梳理和提炼。但是具体的例子我没有详细研究。希望还是能从代码出发才能深入理解

第七章：提纲说的很清楚了，服务器程序的通用细节问题，启发很大。更底层理解各种设计与规范。例如：守护进程、日志系统、用户身份、配置管理、PID、资源限制。

后续的章节就是全书的核心了。

第八章指出核心架构思想：
- I/O处理单元、逻辑单元、存储单元。这些其实可以把所有的服务器简单看出这些架构，不同之处在于逻辑处理。
- 引出常用各种服务器模型：C/S模型。
- I/O模型：讨论了阻塞与非阻塞的异同（强调同步与异步的核心区别：内核与用户态读写I/O）。
- 两种事件处理模式：同步Reactor、异步Proactor。同步模拟异步：多线程。主线程来进行读写操作，工作线程对数据进行逻辑处理。
- 两种并发模式： 半同步/半异步和领导者/追随者模式。
- 提高服务器性能的其他建议：池、数据复制、上下文切换和锁

半同步/半异步模式中，同步线程用于处理客户逻辑，相当于图 8-4中的逻辑单元;异步线程用于处理I/O事件，相当于图8-4中的I/O处理单元。异步线程监听到客户请求后，就将其封装成请求对象并插入请求队列中。请求队列将通知某个工作在同步模式的工作线程来读取并处理该请求对象。

存在很多变体：半同步/半反应堆模式。异步线程只有一个，由主线程来充当。半同步/半反应堆模式采用的事件处理模式是 Rcactor模式∶它要求工作线程自己从 socket上读取客户请求和往 socket写入服务器应答。这就是该模式的名称中"half-reactive"的含义。但是有相应的缺点，而相对更高效的模式是：每个线程维持自己的事件循环，工作在异步模式，主线程只管理监听socket。

领导者/追随者模式：领导者/追随者模式是多个工作线程轮流获得事件源集合，轮流监听、分发并处理事件的一种模式。在任意时间点，程序都仅有一个领导者线程，它负责监听 I/O事件。而其他线程则都是追随者，它们休眠在线程池中等待成为新的领导者。当前的领导者如果检测到I/O 事件，首先要从线程池中推选出新的领导者线程，然后处理 I/O事件。此时，新的领导者等待新的 I/O 事件，而原来的领导者则处理 I/O 事件，二者实现了并发。

> 第八章很多内容可能说的比较抽象或者很理论，但起码让我有一个总的系统思路，而且很贴切实际开发场景。工作中需要从各种服务架构进行归纳、对比和总结。例如：Nginx、redis、node、gevent、甚至goroutine等

第九章I/O复用： select、poll和epoll（LT、ET）之间的比较和各自的使用例子。
> 比较偏向基础、使用和例子，更深层次的对比可以看其他资料

需要指出的是，I/O复用虽然能同时监听多个文件描述符，但它本身是阻塞的。并且当**多个文件描述符同时就绪时**，如果不采取额外的措施，程序就**只能按顺序依次处理其中的每一个文件描述符**，这使得服务器程序看起来像是串行工作的。如果要实现并发，只能使用**多进程或多线程等编程手段**。

第十章信号：介绍信号的含义（比较常用的种类）、如何发送信号和处理信号。信号是一种异步时间、需要进行传递

## 第十一章定时器
- 介绍定时器的意义：服务器程序通常管理着众多定时事件，因此有效地组织这些定时事件，使之能在预期的时间点被触发且不影响服务器的主要逻辑，对于服务器的性能有着至关重要的影响。例如：定期检测连接的活动状态。
- 定时器的几种实现结构：链表、时间轮、时间堆。对比和实现。
- 定时器的触发机制：socket选项、SIGALRM信号、I/O复用系统调用的超时参数。不断更新定时参数反映剩余时间。

> 定时器经常用，但是没有思考其中的原理。redis也有自己的实现。

第12章 高性能I/O框架库Libevent: 介绍优秀的I/O框架。通过Reactor实现的：注册到事件队列中、事件循环。可以从其中学习到：I/O框架注意细节、C语言学习。

> 但可能我没有太详细看代码，章节的内容也比较短。只是简单介绍代码分块，没有很大的收获。并没有加深时间循环的理解

第13章多进程编程：复制进程、僵尸进程、进程间的通信（管道、信号量、消息队列、共享内存）、进程间传递文件描述符的通用方法（UNIX域、管道）。
> 很实用和常见

第十四章多线程编程：
- 创建结束线程。内核线程与用户线程的区别和比较。其中的模式：M:N
- 读取和设置线程属性
- 线程的同步方式：信号量、互斥锁和条件变量。
- 可重入函数（线程安全）、线程与进程、线程与信号

第十五章进程池和线程池：
- 其中的意义与好处
- 接受新连接放进子进程中。主线程往工作队列插入任务，工作线程通过竞争来取得任务并执行它。
> 这里书中跟半同步/半异步 半反应堆结合起来，但是概念好像冲突了，让人疑惑，需要再翻阅其他资料来进行对比验证。

后面两章主要是优化与监测、工具命令的使用。

## 总结
相关知识都很实用、很适合入门，但是核心的几个章节，虽然介绍了几种模式。但感觉并不能很好加深理解并串成一个系统，可能更多是简单的理论知识，需要自己深入研究某一个生产级别的库，以此来验证辅导可能更好。不过作为入门的书籍，收获还是挺多的。希望自身能多些实际验证。

